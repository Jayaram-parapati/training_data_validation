<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fix Training Data</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css"
        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"
        integrity="sha384-cuYeSxntonz0PPNlHhBs68uyIAVpIIOZZ5JqeqvYYIcEL727kskC66kF92t6Xl2V"
        crossorigin="anonymous"></script>
</head>

<style>
    .highlight {
        background-color: red;
        color: white;
    }
</style>

<body>
    <h1>Training Data Validation</h1>

    <!-- <button class="btn btn-sm btn-outline-primary" onclick="prev()">previous</button>
    <button class="btn btn-sm btn-outline-primary" onclick="next()">next</button>
    <div id="text">text here</div> -->
    <div class="container">
        <div class="card" style="">
            <div class="card-body">
                <!-- <h5 class="card-title">Card title</h5>
          <h6 class="card-subtitle mb-2 text-muted">Card subtitle</h6> -->
                <a href="#" class="card-link btn btn-sm btn-outline-secondary" onclick="prev()">Previous</a>
                <a href="#" class="card-link btn btn-sm btn-outline-secondary" onclick="next()">Next</a>
                <p class="card-text" id="text">Text goes here</p>


            </div>
        </div>
    </div>





    <script>
        let td_index = 0
        function next() {
            td_index += 1;
            gettd();
        }
        function prev() {
            td_index -= 1;
            gettd();
        }
        function gettd() {

            fetch(`/tdbyindex/${td_index}`)
                .then(res => {
                    if (!res.ok) {
                        throw new Error(`HTTP error! Status: ${res.status}`);
                    }
                    return res.json();
                })
                .then(data => {
                    let text_container = document.getElementById("text")
                    text_container.innerHTML = ''
                    td = data[0];
                    text = td["text"]
                    ents = td["entities"];
                    for (i = 0; i < ents.length; i++) {
                        let eachEnt = ents[i];
                        let start = eachEnt[0];
                        let end = eachEnt[1];
                        let entity = text.slice(start, end);
                        
                        if (entity) {
                            let regex = new RegExp(entity, 'gi');

                            text = text.replace(regex, (match) => `<span class='highlight'>${match}</span>`);
                        }
                    }
                    text_container.innerHTML = text;
                })
                .catch((error) => {
                    console.log('Fetch error:', error);
                });
        }


        // function sendApi(){
        //     fetch(`/td/64f870a76e38e3e44829bc5c`).then(res=>{
        //         console.log(res)
        //     }).catch(err=>{
        //         console.log('error', err)
        //     })
        // }
    </script>
</body>

</html>